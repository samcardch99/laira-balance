---
import PriceCard from "../../components/PriceCard.astro";
import Layout from "../../layouts/Layout.astro";
import { Image } from "astro:assets";
import right_arrow from "../../assets/prices/right_arrow.svg";
import trial from "../../assets/prices/trial.jpg";
import memberships from "../../assets/prices/membership.jpg";
import class_pack from "../../assets/prices/class_pack.jpg";

import type { SanityDocument } from "@sanity/client";
import { sanityClient } from "sanity:client";
import { getLangFromUrl, useTranslations } from "../../i18n/utils";
import { getRelativeLocaleUrl } from "astro:i18n";
const language = getLangFromUrl(Astro.url);
const t = useTranslations(language);
const lang = Astro.currentLocale || "es";
const scheduleURL = `${getRelativeLocaleUrl(lang, "schedule")}#schedule_widget`;
const CLASES_QUERY = `*[_type == "clases" && language == 'en']{
  _id,
    title,
    "subtitle": subtitle[0].children[0].text,
    price,s

}`;
const PAQUETES_QUERY = `*[_type == "paquetes" && language == 'en'] | order(precio asc)
{
    nombre,
    precio,
    expire,
    precio_unitario,
    link
}`;

const prices = await sanityClient.fetch<SanityDocument[]>(CLASES_QUERY);
const packages = await sanityClient.fetch<SanityDocument[]>(PAQUETES_QUERY);

---

<Layout title="Pricing" description="Explore Laira Balance Studio's pricing options. Discover our unlimited memberships, class packages, and trial classes designed to fit your lifestyle and wellness. Find the perfect balance for you.">
  <main class="min-h-screen w-full flex flex-col relative">
        <section
      id="prices_memberships"
      class="h-[90dvh] w-full relative border border-primary border-t bg-pinkCustom md:flex"
    >
     
      <div
        class="flex flex-col items-center gap-1 md:gap-2 lg:gap-4 w-full md:w-1/2 px-10 text-secondary absolute md:relative bottom-4 self-center z-20"
      >
        <h2 class="italic font-bold text-2xl md:text-3xl lg:text-5xl text-center fade-up-item">
          Unlimited Monthly Membership <br/>$230
        </h2>
        <p class="text-xs md:text-sm text-center text-secondary/70 fade-up-item">
          Monthly Renew
        </p>
        <p class="text-base md:text-lg lg:text-xl text-center fade-up-item">
          Includes access to locker, facial towel<br class="hidden lg:block" /> and
          aromatherapy at the end.
        </p>

        <a
          target="_blank"
          href="https://clients.mindbodyonline.com/classic/ws?studioid=5749033&stype=41&sTG=30&prodId=100017"
          class="rounded-full light px-5 py-3 w-fit mt-4 md:text-lg lg:text-xl lg:!text-pinkCustom fade-up-item"
        >
          Purchase
        </a>
      </div>
       <Image
        quality={80}
        height={1920}
        width={1080}
        quality={90}
        src={memberships}
        alt="trial class section"
        class="h-full w-full md:w-1/2 object-cover filter brightness-75 border border-r border-primary"
      />
    </section>
    <section
      id="prices_classes"
      class="w-full min-h-[90vh] relative content-center"
    >
      <div
        class="px-10 md:px-16 xl:px-32 pt-10 pb-20 md:py-0 md:my-32 grid justify-center place-items-center grid-cols-1 md:grid-cols-[1fr_auto_1fr] gap-20 md:gap-16"
      >
        <div class="flex w-full gap-4 -ml-4 md:ml-0">
          <h1 class="font-bold italic text-6xl lg:text-8xl text-primary fade-up-item">
            Prices
          </h1>
          <Image
            src={right_arrow}
            alt="right_arrow"
            class="hidden md:block h-8 self-center flex-1"
          />
        </div>
        {
          (!prices || prices.length === 0) && (
            <p class="text-center text-primary fade-up-item">
              No hay clases disponibles en este momento.
            </p>
          )
        }
        {
          prices.map((price, index) => {
            return (
              <>
                {index % 2 === 0 && (
                  <div class="hidden md:block w-px bg-primary h-full" />
                )}
                <PriceCard
                  title={price.title}
                  price={price.price}
                  subtitle={price.subtitle}
                  href={scheduleURL}
                  class="w-full fade-up-item"
                />

                {index % 2 === 0 && index < prices.length - 1 && (
                  <div class="hidden md:block col-span-1 md:col-span-3 h-px bg-primary w-full" />
                )}
              </>
            );
          })
        }
      </div>
    </section>
    <section
      id="prices_trial"
      class="h-[100dvh] w-full relative border border-primary border-t bg-pinkCustom md:flex"
    >
      <Image
        quality={80}
        height={1920}
        width={1080}
        quality={90}
        src={trial}
        alt="trial class section"
        class="h-full w-full md:w-1/2 object-cover filter brightness-90 border border-r border-primary"
      />
      <div
        class="flex flex-col items-center gap-1 md:gap-2 lg:gap-4 w-full md:w-1/2 px-10 text-secondary absolute md:relative bottom-4 self-center"
      >
        <h2 class="italic font-bold text-2xl md:text-3xl lg:text-5xl fade-up-item">
          Trial Class: $35
        </h2>
        <p class="text-xs md:text-sm text-center text-secondary/70 fade-up-item">
          Expires 30 days from purchase<br />
          <span>(Only for new members)</span>
        </p>
        <p class="text-base md:text-lg lg:text-xl text-center fade-up-item">
          Includes access to locker, facial towel<br class="hidden lg:block" /> and
          aromatherapy at the end.
        </p>

        <a
          target="_blank"
          href="https://clients.mindbodyonline.com/classic/ws?studioid=5749033&stype=41&sTG=26&prodId=100008"
          class="rounded-full light px-5 py-3 w-fit mt-4 md:text-lg lg:text-xl lg:!text-pinkCustom fade-up-item"
        >
          Purchase
        </a>
      </div>
    </section>
    <section
      id="prices_class_pack"
      class="w-full pt-32 relative flex flex-col md:min-h-[100dvh] md:items-start  "
    >
      <div class="flex flex-col md:flex-row md:items-center w-full">
        <div
          class="flex flex-col gap-10 md:justify-between w-full px-10 md:flex-1"
        >
        {
          packages.map((class_package) => {
            return(
                        <div class="flex w-full justify-between">
            <div class="flex flex-col gap-6 w-3/5">
              <div class="flex flex-col">
                <h2 class="italic font-bold text-3xl lg:text-4xl text-primary fade-up-item">
                  {class_package.nombre}<br /><span class="before:content-['$']">{class_package.precio}</span>
                </h2>
                <p class="text-base italic lg:text-xl text-primary/90 before:content-['$'] fade-up-item">
                 {class_package.precio_unitario}<span>{t('pricing.per-class')}</span>
                </p>
              </div>
              <p class="text-sm lg:text-base text-primary/50 -mt-6 fade-up-item">{class_package.expire}</p>
            </div>
            <a
              target="_blank"
              href={class_package.link}
              class="rounded-full h-fit self-center px-6 py-3 darkPink lg:text-lg fade-up-item"
              >Purchase</a
            >
          </div>
          <div class="w-full h-px bg-primary"></div>
            )
          })
        }
        
<div class="flex flex-col md:w-1/2">
        <p class="italic text-primary font-bold text-xl lg:text-lg fade-up-item">
          Includes locker access, facial towel, and aromatherapy at the end.
        </p>
      </div>
        </div>
        <Image
          src={class_pack}
          alt="class pack"
          height={1920}
          width={1080}
          quality={90}
          class="w-full h-[40vh] md:h-[50vh] lg:h-[60vh] mt-12 md:mt-0 object-cover md:flex-1 md:w-1/2"
        />
      </div>

      
    </section>
    
  </main>
</Layout>
