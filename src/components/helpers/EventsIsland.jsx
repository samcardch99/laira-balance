import { useEffect, useState } from "react";
import { sanityClient } from "sanity:client";

import { Image } from "astro:assets";
const POSTS_QUERY = `*[_type == "post"]{
  _id,
  title,
    Date,
    descripcion,
    "imageUrl": image.asset->url,
    location

}`;

export default function EventsIsland() {
  const [posts, setPosts] = useState([]);

  useEffect(() => {
    sanityClient
      .fetch(POSTS_QUERY)
      .then((data) => setPosts(data))
      .catch(console.error);
  }, []);

  return (
    <section
      id="events_grid"
      className="w-full grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 place-items-center gap-8"
    >
      {(!posts || posts.length === 0) && (
        <p className="text-center text-primary">
          No hay eventos disponibles en este momento.
        </p>
      )}
      {posts.map((post) => (
        <div
          key={post._id}
          className="flex flex-col gap-4 p-3 max-w-[550px] border border-primary/50 text-primary hover:bg-pinkCustom/50 transition-colors duration-200"
        >
          <img
            src={post.imageUrl}
            alt={post.title}
            className="w-96 h-64 object-cover"
          />
          <div className="flex flex-col gap-1">
            <h3 className="font-bold text-2xl">{post.title}</h3>
            <div class="flex gap-2 text-sm">
              <svg
                className="h-4"
                id="Capa_2"
                data-name="Capa 2"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 21.7 22.92"
              >
                <g id="Capa_1-2" data-name="Capa 1">
                  <g>
                    <path
                      d="M6.02,2h9.61V.39s.06-.12.07-.15c.27-.41,1.18-.25,1.18.15v1.61h4.01c.35,0,.85.69.8,1.05v18.81c-.03.52-.37.99-.91,1.05H.94c-.49-.03-.9-.46-.94-.94V2.91c-.01-.32.5-.9.8-.9h3.97V.36s.1-.17.12-.19c.24-.23.81-.22,1.02.04.02.03.11.17.11.18v1.61ZM4.77,3.15c-.06-.02-.07.03-.11.06-.67.51-.58,1.6.17,1.97,1.33.66,2.39-1.19,1.19-2.03v1.09c0,.39-.87.53-1.15.22-.02-.02-.11-.17-.11-.19v-1.13ZM15.63,4.24c-.05-.31.04-.76,0-1.09-.65.39-.74,1.34-.17,1.85.92.82,2.31-.1,1.9-1.27-.09-.24-.25-.46-.47-.58v1.09s-.2.32-.23.34c-.25.17-.96.04-1.02-.34ZM20.91,7.03H.78v15.15h20.14V7.03Z"
                      style={{ strokeWidth: 0 }}
                    />
                    <g>
                      <path
                        d="M7.35,13.06c.46-.07,1.7-.06,2.17,0,.37.04.57.24.61.61.05.52.04,1.51,0,2.03-.03.35-.16.64-.54.68-.51.06-1.69.05-2.22,0-.31-.03-.54-.22-.57-.54-.05-.46-.06-1.85,0-2.29.04-.28.27-.45.54-.49Z"
                        style={{ strokeWidth: 0 }}
                      />
                      <path
                        d="M2.65,13.06c.48-.06,1.64-.06,2.13-.01.32.03.57.2.61.54.06.51.05,1.69,0,2.22-.03.34-.24.54-.57.57-.51.05-1.72.06-2.22,0-.34-.04-.5-.29-.53-.61-.05-.49-.05-1.66,0-2.14.04-.35.23-.52.58-.57Z"
                        style={{ strokeWidth: 0 }}
                      />
                      <path
                        d="M12.07,13.06c.47-.06,1.69-.06,2.17,0,.28.03.54.2.57.5.09.73-.07,1.62,0,2.37-.05.27-.27.43-.54.46-.5.06-1.71.05-2.22,0-.27-.03-.5-.22-.53-.5-.09-.72.07-1.62,0-2.36.07-.27.27-.42.54-.45Z"
                        style={{ strokeWidth: 0 }}
                      />
                      <path
                        d="M9.96,17.83c.09.1.15.27.16.41.05.51.05,1.56,0,2.07-.03.34-.18.61-.54.65-.52.06-1.73.05-2.26,0-.33-.03-.51-.25-.54-.57-.05-.51-.06-1.73,0-2.22.03-.26.24-.48.5-.5.75-.07,1.61.06,2.37,0,.09,0,.24.1.3.16Z"
                        style={{ strokeWidth: 0 }}
                      />
                      <path
                        d="M2.47,17.68c.77.05,1.71-.1,2.47,0,.27.03.43.28.46.54.05.53.05,1.64,0,2.18-.03.31-.22.54-.54.57-.52.06-1.69.05-2.22,0-.36-.03-.54-.26-.57-.61-.05-.5-.05-1.6,0-2.11.03-.28.14-.45.4-.57Z"
                        style={{ strokeWidth: 0 }}
                      />
                      <path
                        d="M16.8,13.06c.47-.06,1.7-.06,2.17-.01.33.04.54.24.57.57.05.54.06,1.69,0,2.22-.03.31-.26.51-.57.54-.51.05-1.73.06-2.22,0-.24-.03-.47-.21-.5-.46-.09-.73.06-1.65,0-2.4.06-.28.27-.42.54-.45Z"
                        style={{ strokeWidth: 0 }}
                      />
                      <path
                        d="M11.93,17.68c.77.05,1.68-.09,2.43,0,.25.03.42.22.46.46-.05.75.07,1.59,0,2.33-.02.26-.24.47-.5.5-.48.06-1.76.05-2.26,0-.29-.03-.5-.21-.53-.5-.06-.49-.06-1.8,0-2.29.03-.25.17-.41.4-.49Z"
                        style={{ strokeWidth: 0 }}
                      />
                      <g>
                        <path
                          d="M7.39,11.79v.15c-.09,0,.02-.18-.09-.15-.05.02.03.15-.06.15.04-.25-.04-.15-.18-.24-.11-.07-.15-.26-.26-.2v-2.49c.04-.33.29-.51.61-.54.51-.05,1.65-.05,2.14,0,.38.04.54.29.57.65.05.55.04,1.48,0,2.04-.02.37-.18.58-.57.64h-2.16Z"
                          style={{ strokeWidth: 0 }}
                        />
                        <path
                          d="M2.58,8.48c.4-.07,1.82-.06,2.25,0,.3.03.54.23.57.54.06.51.05,1.69,0,2.22-.03.33-.24.53-.57.57-.5.06-1.63.05-2.14,0-.38-.03-.57-.23-.61-.61-.05-.49-.05-1.66,0-2.14.04-.29.2-.52.5-.57Z"
                          style={{ strokeWidth: 0 }}
                        />
                        <path
                          d="M14.73,11.56c-.08.12-.29.2-.42.24l-.02.14-.02-.15c-.7-.06-1.51.08-2.2,0-.31-.03-.51-.23-.54-.53-.05-.52-.06-1.79,0-2.29.04-.32.32-.47.61-.5.52-.04,1.63-.05,2.14,0,.26.03.5.23.54.5.09.73-.07,1.62,0,2.37,0,.09-.04.16-.09.23Z"
                          style={{ strokeWidth: 0 }}
                        />
                        <path
                          d="M16.77,8.48c.46-.07,1.73-.06,2.21,0,.28.03.54.2.57.5.06.49.05,1.8,0,2.29-.04.35-.28.51-.61.54-.54.05-1.57.05-2.11,0-.27-.02-.54-.17-.57-.46-.09-.75.07-1.67,0-2.44.08-.25.25-.38.51-.42Z"
                          style={{ strokeWidth: 0 }}
                        />
                      </g>
                    </g>
                  </g>
                </g>
              </svg>

              <h4>{new Date(post.Date).toLocaleDateString()}</h4>
            </div>
            <div class="flex gap-2 text-sm">
              <svg
                id="Capa_2"
                className="h-4"
                data-name="Capa 2"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24.56 24.56"
              >
                <g id="Capa_1-2" data-name="Capa 1">
                  <g>
                    <path
                      d="M12.28,0c3.39,0,6.46,1.37,8.68,3.6,2.22,2.22,3.6,5.29,3.6,8.68s-1.37,6.46-3.6,8.68c-2.22,2.22-5.29,3.6-8.68,3.6s-6.46-1.37-8.68-3.6C1.37,18.74,0,15.67,0,12.28S1.37,5.82,3.6,3.6C5.82,1.37,8.89,0,12.28,0h0ZM19.61,4.95c-1.88-1.88-4.47-3.04-7.33-3.04s-5.45,1.16-7.33,3.04c-1.88,1.88-3.04,4.47-3.04,7.33s1.16,5.45,3.04,7.33c1.88,1.88,4.47,3.04,7.33,3.04s5.45-1.16,7.33-3.04c1.88-1.88,3.04-4.47,3.04-7.33s-1.16-5.45-3.04-7.33Z"
                      style={{
                        fill: "currentColor",
                        fillRule: "evenodd",
                        strokeWidth: 0,
                      }}
                    />
                    <path
                      d="M12.28,13.23c.52,0,.95-.43.95-.95s-.43-.95-.95-.95-.95.43-.95.95.43.95.95.95Z"
                      style={{
                        fill: "currentColor",
                        fillRule: "evenodd",
                        strokeWidth: 0,
                      }}
                    />
                    <polygon
                      points="11.71 12.28 12.84 12.28 12.46 4.07 12.1 4.07 11.71 12.28"
                      style={{
                        fill: "currentColor",
                        fillRule: "evenodd",
                        strokeWidth: 0,
                      }}
                    />
                    <polygon
                      points="12.56 11.79 12 12.77 17.72 15.63 17.9 15.31 12.56 11.79"
                      style={{
                        fill: "currentColor",
                        fillRule: "evenodd",
                        strokeWidth: 0,
                      }}
                    />
                  </g>
                </g>
              </svg>

              <h4>8:00 AM - 9:30 AM</h4>
            </div>
            <div class="flex gap-2 text-sm">
              <svg
                className="h-4"
                id="Capa_2"
                data-name="Capa 2"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 19.6 24.71"
              >
                <g id="Capa_1-2" data-name="Capa 1">
                  <g>
                    <path
                      d="M9.8,18.74c-5.41,0-9.8,1.34-9.8,2.98s4.39,2.98,9.8,2.98,9.8-1.34,9.8-2.98-4.39-2.98-9.8-2.98ZM14.7,22.58c-1.3.4-3.05.62-4.9.62s-3.6-.22-4.9-.62c-1.34-.41-1.81-.89-1.81-1.17s.47-.76,1.81-1.17c1.3-.4,3.05-.62,4.9-.62h0c1.86,0,3.6.22,4.9.62,1.34.41,1.81.89,1.81,1.17s-.47.76-1.81,1.17Z"
                      style={{ fill: "currentColor", strokeWidth: 0 }}
                    />
                    <path
                      d="M9.83,0C5.61,0,2.19,3.42,2.19,7.64c0,.72.1,1.43.29,2.09.12.41.24.82.44,1.18,1.57,2.87,6.9,11.1,6.9,11.1,0,0,5.34-8.23,6.9-11.1.2-.37.33-.77.44-1.18.19-.66.29-1.36.29-2.09,0-4.22-3.42-7.64-7.64-7.64ZM9.83,11c-1.07,0-2.02-.5-2.63-1.27-.46-.57-.73-1.3-.73-2.09,0-1.85,1.51-3.36,3.36-3.36s3.36,1.51,3.36,3.36c0,.79-.27,1.52-.73,2.09-.62.78-1.57,1.27-2.63,1.27Z"
                      style={{ fill: "currentColor", strokeWidth: 0 }}
                    />
                  </g>
                </g>
              </svg>

              <h4>{post.location}</h4>
            </div>
          </div>
        </div>
      ))}
    </section>
  );
}
